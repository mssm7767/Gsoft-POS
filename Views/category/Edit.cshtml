@model GSoftPosNew.Models.Category

@{
    ViewData["Title"] = "Edit Category";
    Layout = "~/Views/Shared/_Layout.cshtml";
    var isEdit = ViewBag.IsEdit as bool? ?? false;
}
<link href="~/css/category.css" rel="stylesheet" />

<div class="container py-4">
    <!-- Breadcrumb Modern Header -->
    <div class="d-flex align-items-center mb-4 p-3 rounded shadow-sm"
         style="background: linear-gradient(93deg,#bdc3c7 15%,#5d9fff 100%);">
        <span class="fw-bold text-white fs-5"><i class="fa-solid fa-edit me-2"></i> Edit Category</span>
    </div>

    <!-- Form Card -->
    <div class="card shadow-lg border-0 rounded-4 mb-5">
        <div class="card-header rounded-top-4"
             style="background:linear-gradient(91deg,#313866 65%,#92e6e6 100%); color:#fff; border:none;">
            <i class="fa-solid fa-layer-group fa-lg me-2"></i>
            <span class="fw-semibold">@((isEdit ? "Edit Category" : "Add Category"))</span>
        </div>
        <div class="card-body bg-light rounded-bottom-4">
            @if (TempData["Success"] != null)
            {
                <div class="alert alert-success text-center shadow-sm mb-4" id="alert-success">
                    <i class="fa-solid fa-check-circle me-1"></i> @TempData["Success"]
                </div>
            }
            @if (TempData["Danger"] != null)
            {
                <div class="alert alert-danger text-center shadow-sm mb-4" id="alert-danger">
                    <i class="fa-solid fa-check-circle me-1"></i> @TempData["Danger"]
                </div>
            }
            @using (Html.BeginForm("Edit", "Category", FormMethod.Post))
            {
                @Html.AntiForgeryToken()
                <div class="row g-3 align-items-end">
                    <div class="col-md-4">
                        <label class="form-label"><i class="fa-solid fa-tag text-primary me-1"></i> Category Name *</label>
                        @Html.TextBoxFor(m => m.Name, new { @class = "form-control", placeholder = "Enter category name" })
                        @Html.ValidationMessageFor(m => m.Name, "", new { @class = "text-danger" })
                    </div>
                    <div class="col-md-4">
                        <label class="form-label"><i class="fa-regular fa-align-left text-info me-1"></i> Description</label>
                        @Html.TextBoxFor(m => m.Description, new { @class = "form-control", placeholder = "Category description" })
                    </div>
                    <div class="col-md-4">
                        <label class="form-label"><i class="fa-solid fa-percent text-success me-1"></i> Discount (%)</label>
                        @Html.TextBoxFor(m => m.Discount, new { @class = "form-control", type = "number", min = "0", max = "100", placeholder = "0", value = "0" })
                    </div>
                </div>
                <div class="mt-4 d-flex justify-content-end gap-3">
                    <button type="button" class="btn btn-primary btn-lg rounded-pill shadow"
                            style="background:linear-gradient(93deg,#313866 55%,#92e6e6 100%);border:none;" disabled>
                        <i class="fa-solid fa-save me-1"></i> Save Category
                    </button>
                    <button type="submit" class="btn btn-warning btn-lg rounded-pill shadow"
                            style="background:linear-gradient(93deg,#f7971e 45%,#ffd200 100%);border:none;">
                        <i class="fa-solid fa-pen-to-square me-1"></i> Edit Category
                    </button>
                </div>
            }
        </div>
    </div>

    <!-- List Card -->
    <div class="card shadow-lg border-0 rounded-4">
        <div class="card-header d-flex align-items-center rounded-top-4"
             style="background:linear-gradient(92deg,#5d9fff 40%,#313866 90%); color:#fff;">
            <i class="fa-solid fa-list fa-lg me-2"></i>
            <span class="fw-bold">All Categories</span>
        </div>
        <div class="card-body bg-white rounded-bottom-4 p-0">
            <div class="table-responsive">
                <table class="table table-striped align-middle mb-0">
                    <thead class="table-light">
                        <tr>
                            <th><i class="fa-solid fa-tag"></i> Name</th>
                            <th><i class="fa-regular fa-align-left"></i> Description</th>
                            <th><i class="fa-solid fa-percent"></i> Discount %</th>
                            <th class="text-center" style="width:110px;">Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var c in ViewBag.CategoryList as List<GSoftPosNew.Models.Category>)
                        {
                            <tr>
                                <td>@c.Name</td>
                                <td>@c.Description</td>
                                <td>@c.Discount</td>
                                <td class="text-center">
                                    <a href="@Url.Action("Edit", "Category", new { id = c.Id })" class="btn btn-sm btn-outline-primary me-2" title="Edit">
                                        <i class="fa-solid fa-pen-to-square"></i>
                                    </a>
                                    <a href="@Url.Action("Delete", "Category", new { id = c.Id })"
                                       onclick="return confirm('Are you sure you want to delete this category?');"
                                       class="btn btn-sm btn-outline-danger" title="Delete">
                                        <i class="fa-solid fa-trash"></i>
                                    </a>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
<script>
    // Run after DOM is ready
    setTimeout(() => {
        let alertBox = document.getElementById("alert-success");
        if (alertBox) {
            alertBox.style.display = "none";
        }
    }, 2000);
    setTimeout(() => {
        let alertBox = document.getElementById("alert-danger");
        if (alertBox) {
            alertBox.style.display = "none";
        }
    }, 2000);
</script>